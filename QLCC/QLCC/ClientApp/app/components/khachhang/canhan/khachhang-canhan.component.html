
<section class="content-header">
    <h1>Quản lý khách hàng - cá nhân</h1>
    <commonroad></commonroad>
</section>
<section class="content">
    <div class="row">
        <div class="col-xs-12">
            <div style="margin-bottom:1%" class="col-sm-6">
                <div class="row">
                    <search-box (searchChange)="onSearchChanged($event)" placeholder="Tìm kiếm">></search-box>
                </div>
            </div>
            <div style="margin-bottom:1%;" align="right" class="col-sm-6">
                <div class="row">
                    <a class="btn btn-primary" href="javascript://" tooltip="Thêm mới" (click)="newKhachHang()"><i class="fa fa-plus"></i></a>
                    <a class="btn btn-primary" href="javascript://" tooltip="Import khách hàng cá nhân" (click)="importKhachHangCaNhan()"><i class="fa fa-upload"></i></a>
                    <a class="btn btn-primary" href="javascript://" tooltip="Xuất dữ liệu khách hàng cá nhân" (click)="excelexport.save()" (mouseenter)="changeRandomString()">
                        <i class="fa fa-download"></i>
                        <kendo-excelexport [data]="rows" fileName="KhachHangCaNhanExPort-{{randomString}}.xlsx" #excelexport [headerPaddingCellOptions]="headerPaddingCells">
                            <kendo-excelexport-column field="index" [locked]="true" title="STT" [width]="50" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b',fontweight:'bold' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="hoDem" title="Họ đệm" [width]="120" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="ten" title="Tên" [width]="120" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="ngaySinh" title="Ngày sinh" [width]="120" [cellOptions]="{ format: 'd-mmm-yy' }" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="nhomKhachHang.tenNhomKhachHang" title="Nhóm khách hàng" [width]="120" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b',bordercolor:'#000' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="gioiTinhN" title="Giới tính" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="thuongTru" title="Thường Trú" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="diaChi" title="Nơi ở hiện tại" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="dienThoai" title="Điện thoại" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="email" title="Email" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="mst" title="Mã số thuể" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="cmt" title="CMTND" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="ngayCap" title="Ngày cấp" [width]="200" [cellOptions]="{ format: 'd-mmm-yy' }" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="noiCap" title="Nơi cấp" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="quocTich" title="Quốc tịch" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="nganHang" title="Ngân hàng" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                            <kendo-excelexport-column field="tkNganHang" title="Tài khoản ngân hàng" [width]="200" [headerCellOptions]="{ textAlign: 'center',background:'#048b8b' }">
                            </kendo-excelexport-column>
                        </kendo-excelexport>
                    </a>
                    <a class="btn btn-primary menubar" href="javascript:;" tooltip="Danh mục">
                        <i class="fa fa-bars"></i>
                        <ul class="nav navbar-nav child-menu">
                            <li><a href="javascript:;" routerLink="/nhomkhachhang">QL Nhóm khách hàng</a></li>
                            <li><a href="javascript:;" routerLink="/trangthaicudan">QL Trạng thái cư dân</a></li>
                            <li><a href="javascript:;" routerLink="/trangthaiyeucau">QL Trạng thái yêu cầu</a></li>
                            <li><a href="javascript:;" routerLink="/loaiyeucau">QL loại yêu cầu</a></li>
                            <li><a href="javascript:;" routerLink="/mucdouutien">QL Mức độ ưu tiên</a></li>
                            <li><a href="javascript:;" routerLink="/nguontiepnhan">QL Nguồn tiếp nhận</a></li>
                            <li><a href="javascript:;" routerLink="/quanhechuho">QL Quan hệ chủ hộ</a></li>
                        </ul>
                    </a>
                </div>
            </div>

            <div class="clearfix"></div>
            <div class="box box-info">
                <!-- /.box-header -->
                <div class="box-body">
                    <div>
                        <div class="dataTables_length">
                            <label>
                                Nhóm khách hàng
                                <select class="form-control input-sm" #drGroup (change)="SelectedGroupValue(drGroup.value)" [(ngModel)]="selectedGropup">
                                    <option value="0">---Tất cả---</option>
                                    <option *ngFor="let o of nhomKhachHang" [value]="o.nhomKhachHangId">
                                        {{o.tenNhomKhachHang}}
                                    </option>
                                </select>

                            </label>
                        </div>
                        <div class="DTTT_container">
                            <label>
                                Hiển thị
                                <select class="form-control input-sm" #drSelected (change)="SelectedValue(drSelected.value)">
                                    <option value="10">10</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select> bản ghi
                            </label>
                        </div>
                        <div class="clearfix"></div>
                        <ngx-datatable class="material colored-header sm table table-striped table-hover "
                                       [loadingIndicator]="loadingIndicator"
                                       [rows]="rows"
                                       [rowHeight]="45"
                                       [headerHeight]="45"
                                       [footerHeight]="45"
                                       [columns]="columns"
                                       [limit]="limit"
                                       [columnMode]="'force'">
                        </ngx-datatable>
                        <ng-template #fullNameTemplate let-row="row" let-value="value" let-i="index">
                            <p>{{row.hoDem}}&nbsp;{{row.ten}}</p>
                        </ng-template>
                        <ng-template #actionsTemplate let-row="row" let-value="value" let-i="index" style="text-align:center">
                            <a class="btn btn-func btn-success" href="javascript:;" title="Chi tiết" (click)="viewKhachHang(row)"><i class="fa fa-eye"></i></a>
                            <a class="btn btn-func btn-primary" href="javascript:;" (click)="editKhachHang(row)" title="Sửa"><i class="fa fa-pencil" aria-hidden="true"></i></a>
                            <a class="btn btn-func btn-danger" href="javascript:;" (click)="deleteKhachHang(row)" title="Xóa"><i class="fa fa-trash-o" aria-hidden="true"></i></a>
                        </ng-template>
                        <!--modal-->
                        <khachhang-canhan-info #khachhangEditor [isGeneralEditor]="true"></khachhang-canhan-info>
                        <!--EndModal-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>